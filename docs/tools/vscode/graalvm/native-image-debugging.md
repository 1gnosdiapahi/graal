---
layout: docs
toc_group: native-image
link_title: Debug Native Images in VS Code
permalink: /reference-manual/native-image/debugging/
---

# Debug Native Images in VS Code

You can debug a native executable generated by GraalVM Native Image from the command line with the GNU Debugger, or from within Visual Studio Code (VS Code) by means of the [GraalVM Tools for Java extension](https://marketplace.visualstudio.com/items?itemName=oracle-labs-graalvm.graalvm).

In this guide you will learn how to debug a Java application compiled into a native executable from VS Code.

To learn how to debug Java from GDB, see the dedicated [Native Image Debug Info Feature reference manual](../../../reference-manual/native-image/DebugInfo.md).

## Demo Part

You can debug a native image process the same way as debugging a regular Java application: when your native executable is running, the debugger attaches to the application process, the Java source file is opened, letting you debug it. You can perform regular debugging actions like setting breakpoints, creating watches, inspecting the state of your application, etc.
Attaching of the debugger is enabled by adding a separate configuration, **Native Image: launch**, into the _launch.json_ file.

> Note: To debug a native image from within VS Code, you must install GraalVM Enterprise.

### Prerequisities
1. Linux OS with GDB 10.1
2. [Visual Studio Code](https://code.visualstudio.com/)
3. [GraalVM Extension Pack for Java](https://marketplace.visualstudio.com/items?itemName=oracle-labs-graalvm.graalvm-pack): Open VS Code and navigate to **Extensions** in the left-hand side activity bar (or use the _Ctrl+Shift+X_ keys combination). Search for “GraalVM” in the search field, find "GraalVM Extension Pack for Java" and press **Install**. Reload when required.
4. [GraalVM Enterprise](https://www.graalvm.org/downloads) runtime environment: Navigate to **Gr** activity panel in VS Code and install some of the latest **GraalVM Enterprise** editions available from the list.
5. [Native Image](../../../reference-manual/native-image/README.md): Upon GraalVM's installation completion, the **Install Optional GraalVM Components** window will pop up in the right bottom corner. Install Native Image.

### Create and Build the Demo

The demo is a simple Maven-based Java factorial calculator that uses the [Native Build Tools for GraalVM Native Image](https://graalvm.github.io/native-build-tools/latest/index.html).

The Maven _pom.xml_ file is extended with a native profile, which makes building a native executable easier (read more about Maven Profiles [here](https://maven.apache.org/guides/introduction/introduction-to-profiles.html)).
To add debug information, the <buildArg> tags are used in the native profile configuration to pass parameters to the `native-image` build process:

```xml
 <buildArg>-g</buildArg>
 <buildArg>-O0</buildArg>
```
Where `-g` instructs the `native-image` builder to generate debug information, and `-O0` specifies to not perform any optimizations.

1. Clone the [demos repository from GitHub](https://github.com/graalvm/graalvm-demos) and open the `javagdbnative` folder in VS Code:

  ```
  git clone https://github.com/graalvm/graalvm-demos.git
  ```

2. In VS Code, open **Terminal**, then click **New Terminal**, and run following command:

  ```shell
  mvn -Pnative -DskipTests package
  ```
  This command packages a Java application into a runnable JAR file, and then builds a native image of it.
  Once you have your executable with debug symbols generated, the next step is to add the Native Image debugger configuration,  **Native Image: launch**, into the _launch.json_ file in VS Code.

3. Select **Run | Add Configuration…** and then select **Native Image: Launch** from the list of available configurations. It will add the following code to _launch.json_:

  ```JSON
  {
   “type”: “nativeimage”,
   “request”: “launch”,
   “name”: “Launch Native Image”,
   “nativeImagePath”: “${workspaceFolder}/build/native-image/application”
   }
  ```
   The value of the `nativeImagePath` property has to match the executable name and the location specified in the _pom.xml_, so change the last line of the configuration to `"nativeImagePath": "${workspaceFolder}/target/javagdb"`.

4. Add some argument to specify the number that you want to calculate the factorial, for example, `“args”: “100”`. Your configuration should look like this:
  ```JSON
  {
   “type”: “nativeimage”,
   “request”: “launch”,
   “name”: “Launch Native Image”,
   “nativeImagePath”: “${workspaceFolder}/target/javagdb”,
   “args”: “100”
   }
   ```

### Run and Debug the Demo

To run the application in debug mode, first set a breakpoint in the source code.
Then go to the **Run and Debug** activity in the top navigation panel, select **Launch Native Image** and click the green arrow to run this configuration.
VS Code will execute your native executable, attach to the application process, open the Java source file, letting you debug it.
You step over the code, explore local variables, specify expressions to be evaluated, etc.
Everything you can do when debugging a Java application from an IDE.

![Native Image debugging source code](images/debugging_ni_vscode.png)

Notice that some code is greyed out in the source file. For example, the method `neverCalledMethod()`:

![Uncalled method greyed out](images/uncalled_method.png)

The `native-image` builder removes the code that is not used by the application at run time.
This could be some uncalled library or some unreachable methods.
The VS Code extension recognises these elimitations and will grey out both the body of eliminated method and the method call.
The shaded code is not a part of the native executable.
